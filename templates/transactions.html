{% extends "base.html" %}

{% block title %}Transacciones - Rudag Explorer{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>
        <i class="fas fa-exchange-alt me-2"></i>Transacciones
    </h1>
    <span class="badge bg-primary fs-6">Total: {{ transactions|length }}</span>
</div>

<div class="card bg-dark text-light">
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-dark table-hover mb-0">
                <thead>
                    <tr>
                        <th>Tipo</th>
                        <th>Bloque</th>
                        <th>De</th>
                        <th>Para</th>
                        <th>Monto</th>
                        <th>Fee</th>
                        <th>Timestamp</th>
                    </tr>
                </thead>
                <tbody>
                    {% for tx in transactions %}
                    <tr>
                        <td>
                            {% if tx.tipo == 'coinbase' %}
                            <span class="badge bg-success">Coinbase</span>
                            {% else %}
                            <span class="badge bg-primary">Regular</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{{ url_for('block_detail', block_height=tx.block_height) }}" class="text-info">
                                #{{ tx.block_height }}
                            </a>
                        </td>
                        <td>
                            {% if tx.tipo == 'coinbase' %}
                            <em class="text-muted">Sistema</em>
                            {% else %}
                            <code class="text-info small" title="{{ tx.envia }}">
                                {{ tx.envia[:12] }}...
                            </code>
                            {% endif %}
                        </td>
                        <td>
                            <code class="text-success small" title="{{ (tx.get('destino') or tx.get('recibe')) }}">
                                {{ (tx.get('destino') or tx.get('recibe'))[:12] }}...
                            </code>
                        </td>
                        <td class="text-warning">
                            {% if tx.tipo == 'coinbase' %}
                            {{ "%.1f"|format(tx.recompensa) }} RGD
                            {% else %}
                            {{ "%.3f"|format(tx.monto) }} RGD
                            {% endif %}
                        </td>
                        <td class="text-muted">
                            {{ "%.3f"|format(tx.get('fee', 0)) }} RGD
                        </td>
                        <td class="text-muted small">
                            {{ format_timestamp(tx.timestamp) }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}